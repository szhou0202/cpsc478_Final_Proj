See previz.c and helpers.h for the majority of my code.
